if(!customElements.get("search-suggestions")){let e=class extends HTMLElement{connectedCallback(){this.searchTimeoutID=-1,this.searchInput=this.closest("form").querySelector('input[name="q"]'),this.searchInput.addEventListener("keyup",this.handleInputChange.bind(this)),this.searchInput.addEventListener("change",this.handleInputChange.bind(this))}handleInputChange(){let e=this.searchInput.value;e.length&&e!==this.oldSearchValue?(clearTimeout(this.searchTimeoutID),this.searchTimeoutID=setTimeout(()=>{this.fetchSuggestions(e)},500)):e.length||(clearTimeout(this.searchTimeoutID),this.searchSuggestionsAbortController&&(this.searchSuggestionsAbortController.abort(),this.searchSuggestionsAbortController=null),this.innerHTML=""),this.oldSearchValue=e}fetchSuggestions(e){this.searchSuggestionsAbortController&&this.searchSuggestionsAbortController.abort(),this.searchSuggestionsAbortController=new AbortController,fetch(`${theme.routes.predictiveSearch}?q=${encodeURIComponent(e)}&section_id=search-suggestions`,{signal:this.searchSuggestionsAbortController.signal}).then(e=>{if(!e.ok)throw Error(e.status);return e.text()}).then(e=>{let t=new DOMParser().parseFromString(e,"text/html").querySelector(".search-suggestions-wrapper");this.innerHTML="",this.insertAdjacentElement("beforeend",t.firstElementChild)}).catch(e=>{if(20!==e.code)throw e})}};window.customElements.define("search-suggestions",e)}
